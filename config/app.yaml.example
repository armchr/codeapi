# CodeAPI Application Configuration
# Copy this file to app.yaml and update with your settings

app:
  port: 8181
  codegraph: true
  # Number of threads for file processing
  num_file_threads: 5
  # Max concurrent files to process in indexFile API
  max_concurrent_file_processing: 5

# Language Server Configuration
# Add new languages by adding entries in the format:
#   <language>: <path to language server executable>
language_servers:
  go: "${CODEAPI_ROOT}/scripts/gopls.sh"
  python: "${CODEAPI_ROOT}/scripts/pylsp.sh"
  csharp: "${CODEAPI_ROOT}/scripts/cslsp.sh"
  # java: "${CODEAPI_ROOT}/scripts/jdtls.sh"
  # typescript: "${CODEAPI_ROOT}/scripts/tsserver.sh"

# Neo4j Configuration (Code Graph Storage)
neo4j:
  uri: "bolt://localhost:7687"
  username: "neo4j"
  password: "your-neo4j-password"

# MySQL Configuration (File Version Tracking)
mysql:
  host: "localhost"
  port: 3306
  username: "root"
  password: "your-mysql-password"
  database: "codeapi"

# Qdrant Configuration (Vector Embeddings)
qdrant:
  host: "localhost"
  port: 6334  # gRPC port (6333 is HTTP/REST)
  apikey: ""

# Ollama Configuration (Embedding Model)
ollama:
  url: "http://localhost:11434"
  apikey: ""
  # Embedding model options:
  # - qwen3-embedding:0.6b (1024 dimensions)
  # - nomic-embed-text (768 dimensions)
  # - all-minilm (384 dimensions)
  # - mxbai-embed-large (1024 dimensions)
  model: "nomic-embed-text"
  dimension: 768  # Must match the model's output dimension

# Code Chunking Configuration
chunking:
  # Minimum lines for conditionals to be stored as separate chunks
  min_conditional_lines: 8
  # Minimum lines for loops to be stored as separate chunks
  min_loop_lines: 8

# Index Building Configuration (CLI mode)
index_building:
  # Build code graph using tree-sitter and LSP
  enable_code_graph: true
  # Generate and store code embeddings in vector DB
  enable_embeddings: false

# Code Graph Optimization
code_graph:
  # Use batch writes for nodes and relationships (faster for large repos)
  enable_batch_writes: false
  # Number of nodes/relations to accumulate before writing to DB
  batch_size: 10
  # Print parse tree for debugging
  print_parse_tree: false
