# Hierarchical Code Summary Prompt Templates
#
# This file defines prompts for generating code summaries at different levels:
# - function: Individual functions and methods
# - class: Classes with their method summaries
# - file: Source files with their class/function summaries
# - folder: Folders/modules with their file summaries
# - project: Entire project overview
#
# Template variables use Go text/template syntax.
# Available context fields vary by level - see context_fields for each level.

defaults:
  max_tokens: 500
  temperature: 0.3

levels:
  function:
    system_prompt: |
      You are a code documentation expert. Be extremely concise and direct.
      Output ONLY the summary in this exact format, nothing else:
      ONE_LINE: <one sentence>
      DESCRIPTION: <2 sentences max>
      SIDE_EFFECTS: <effects or "None">
    user_prompt: |
      {{.Language}} function {{.Name}}{{if .ClassName}} in {{.ClassName}}{{end}}:
      ```{{.Language}}
      {{.SourceCode}}
      ```
    context_fields:
      - name
      - signature
      - docstring
      - source_code
      - parameters
      - return_type
      - annotations
      - modifiers
      - class_name
    max_context_chars: 4000
    max_tokens: 600

  class:
    system_prompt: |
      You are a code documentation expert. Be extremely concise.
      Output a 2-3 sentence summary of the class's purpose and responsibility.
    user_prompt: |
      {{.Language}} class {{.Name}}{{if .Inheritance}} extends {{range $i, $v := .Inheritance}}{{if $i}}, {{end}}{{$v}}{{end}}{{end}}{{if .Implements}} implements {{range $i, $v := .Implements}}{{if $i}}, {{end}}{{$v}}{{end}}{{end}}
      {{if .Fields}}Fields: {{range .Fields}}{{.Name}}:{{.Type}}, {{end}}{{end}}
      {{if .MethodSummaries}}Methods: {{range .MethodSummaries}}{{.Name}}, {{end}}{{end}}
    context_fields:
      - name
      - docstring
      - inheritance
      - implements
      - fields
      - method_summaries
      - annotations
      - modifiers
    max_context_chars: 8000
    max_tokens: 600

  file:
    system_prompt: |
      You are a code documentation expert. Be extremely concise.
      Output a 2-3 sentence summary of the file's purpose.
    user_prompt: |
      {{.Language}} file: {{.FilePath}}
      {{if .ModuleName}}Module: {{.ModuleName}}{{end}}
      {{if .ClassSummaries}}Classes: {{range .ClassSummaries}}{{.Name}}, {{end}}{{end}}
      {{if .FunctionSummaries}}Functions: {{range .FunctionSummaries}}{{.Name}}, {{end}}{{end}}
    context_fields:
      - file_path
      - file_name
      - package_name
      - module_name
      - imports
      - class_summaries
      - function_summaries
    max_context_chars: 8000
    max_tokens: 600

  folder:
    system_prompt: |
      You are a code documentation expert. Be extremely concise.
      Output a 2-3 sentence summary of the module's purpose.
    user_prompt: |
      Folder: {{.FolderPath}}
      {{if .FileSummaries}}Files: {{range .FileSummaries}}{{.Name}}, {{end}}{{end}}
      {{if .SubfolderSummaries}}Subfolders: {{range .SubfolderSummaries}}{{.Name}}, {{end}}{{end}}
    context_fields:
      - folder_path
      - folder_name
      - file_summaries
      - subfolder_summaries
      - languages
    max_context_chars: 12000
    max_tokens: 600

  project:
    system_prompt: |
      You are a code documentation expert. Be concise.
      Output a 3-5 sentence overview of the project.
    user_prompt: |
      Project: {{.ProjectName}} ({{range $i, $v := .Languages}}{{if $i}}, {{end}}{{$v}}{{end}})
      Stats: {{.TotalFiles}} files, {{.TotalClasses}} classes, {{.TotalFunctions}} functions
      {{if .TopLevelSummaries}}Components: {{range .TopLevelSummaries}}{{.Name}}, {{end}}{{end}}
      {{if .EntryPoints}}Entry points: {{range .EntryPoints}}{{.}}, {{end}}{{end}}
    context_fields:
      - project_name
      - languages
      - top_level_summaries
      - entry_points
      - total_files
      - total_classes
      - total_functions
    max_context_chars: 16000
    max_tokens: 800
